# This is a simple script to scan for software vulnerabilities on a Windows 11 Machine.
# It will scan for vulnerabilities on the machine and return a list of software, software version,vulnerabilities, severity, and CVE citation.

# This script will use the following API:
# https://nvd.nist.gov/developers/request-an-api-key

# Software Vulnerability Scanner for Windows 11
# Uses NVD API for comprehensive vulnerability data

# Configuration
$apiKey = "YOUR-NVD-API-KEY"
$nvdApiBase = "https://services.nvd.nist.gov/rest/json/cves/2.0"

# Function to get installed software
function Get-InstalledSoftware {
    Get-WmiObject -Class Win32_Product | 
    Select-Object Name, Version
}

# Function to query NVD API
function Get-VulnerabilityData {
    param (
        [string]$software,
        [string]$version
    )
    
    $uri = "$nvdApiBase?keywordSearch=$software&apiKey=$apiKey"
    
    try {
        $response = Invoke-RestMethod -Uri $uri -Method Get
        return $response.vulnerabilities | Where-Object {
            $_.cve.descriptions.value -like "*$software*"
        }
    }
    catch {
        Write-Warning "Error querying NVD API: $_"
        return $null
    }
}

